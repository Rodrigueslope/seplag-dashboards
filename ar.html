<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Qualidade do Ar - SEPLAG-CE</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
            margin-bottom: 30px;
        }
        .header-left {
            display: flex;
            align-items: center;
        }
        .header-left img {
            height: 50px;
            margin-right: 15px;
        }
        .header-left h1 {
            margin: 0;
            font-size: 24px;
            color: #333;
        }
        .update-info {
            font-size: 12px;
            color: #666;
        }
        .dashboard-box {
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 30px;
        }
        .dashboard-box h3 {
            text-align: center;
            color: #009933;
            margin-bottom: 20px;
        }
        .back-button {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #009933;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
        }
        .footer {
            text-align: center;
            margin-top: 50px;
            color: #666;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-left">
            <img src="RBIM.png" alt="RBIM Logo">
            <h1>Qualidade do Ar</h1>
        </div>
        <div class="update-info">
            Atualizado em: <span id="update-date"></span>
        </div>
    </div>

    <div class="container">
        
        <div class="dashboard-box">
            <h3>Índice Atual de Qualidade do Ar (AQI)</h3>
            <div id="aqi-gauge"></div>
        </div>

        <div class="dashboard-box">
            <h3>Tendência do AQI nas Últimas 24 Horas</h3>
            <div id="aqi-trend"></div>
        </div>

        <div style="text-align: center;">
            <a href="index.html" class="back-button">Voltar para Dashboards</a>
        </div>

        <div class="footer">
            <p>Este dashboard foi desenvolvido para o tour virtual Matterport da SEPLAG-CE.</p>
        </div>

    </div>

    <script>
        // Atualizar a data de atualização
        document.getElementById('update-date').textContent = new Date().toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });

        // Simulação de dados de AQI
        let aqiAtual = 45;
        const aqiValores = Array(24).fill().map((_, i) => aqiAtual + Math.sin(i / 3) * 5);

        // Gague AQI Atual
        const aqiGauge = {
            type: "indicator",
            mode: "gauge+number",
            value: aqiAtual,
            title: { text: "AQI Agora", font: { size: 24 } },
            gauge: {
                axis: { range: [0, 300] },
                steps: [
                    { range: [0, 50], color: "lightgreen" },
                    { range: [50, 100], color: "yellow" },
                    { range: [100, 150], color: "orange" },
                    { range: [150, 200], color: "red" },
                    { range: [200, 300], color: "purple" }
                ],
                threshold: {
                    line: { color: "red", width: 4 },
                    thickness: 0.75,
                    value: 100
                }
            }
        };

        Plotly.newPlot('aqi-gauge', [aqiGauge], {
            margin: { t: 50, b: 20, l: 20, r: 20 },
            height: 300
        });

        // Gráfico Tendência - Linha animada tipo "onda"
        const trace = {
            x: Array.from({length: 24}, (_, i) => `${i}h`),
            y: [...aqiValores],
            type: 'scatter',
            mode: 'lines+markers',
            line: { shape: 'spline', color: 'green' },
            fill: 'tozeroy',
            fillcolor: 'rgba(0,153,51,0.2)'
        };

        const layout = {
            xaxis: { title: 'Últimas Horas' },
            yaxis: { title: 'AQI', range: [0, 100] },
            margin: { t: 20, b: 40, l: 50, r: 20 },
            height: 400
        };

        Plotly.newPlot('aqi-trend', [trace], layout);

        // Atualizar automaticamente o gráfico de tendência (efeito onda)
        setInterval(() => {
            const novoValor = 45 + Math.sin(Date.now() / 100000) * 10 + Math.random() * 5;
            aqiValores.shift();
            aqiValores.push(Math.max(0, Math.min(100, novoValor)));

            Plotly.update('aqi-trend', {
                y: [aqiValores]
            });
        }, 30000); // Atualiza a cada 30 segundos

    </script>

</body>
</html>
